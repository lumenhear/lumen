// Navbar scroll state
const header = document.querySelector('.navbar');
const backToTop = document.querySelector('.back-to-top');
window.addEventListener('scroll', () => {
  const y = window.scrollY;
  header.classList.toggle('scrolled', y > 10);
  backToTop.classList.toggle('visible', y > 500);
});

// Mobile nav toggle
const toggle = document.querySelector('.nav-toggle');
const menu = document.querySelector('#nav-menu');
if (toggle && menu){
  toggle.addEventListener('click', () => {
    const expanded = toggle.getAttribute('aria-expanded') === 'true';
    toggle.setAttribute('aria-expanded', String(!expanded));
    menu.classList.toggle('show');
  });
  // close menu when clicking a link
  menu.querySelectorAll('a').forEach(a => a.addEventListener('click', () => {
    menu.classList.remove('show');
    toggle.setAttribute('aria-expanded','false');
  }));
}

// Smooth reveal animations using IntersectionObserver
const io = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) entry.target.classList.add('show');
  });
}, {threshold: 0.12});

document.querySelectorAll('.reveal').forEach(el => io.observe(el));

// Testimonials slider
const slides = Array.from(document.querySelectorAll('.slide'));
let idx = 0;
function show(i){
  slides.forEach((s, n) => s.classList.toggle('active', n === i));
}
show(idx);
const next = document.querySelector('.slide-btn.next');
const prev = document.querySelector('.slide-btn.prev');
next && next.addEventListener('click', () => { idx = (idx + 1) % slides.length; show(idx); });
prev && prev.addEventListener('click', () => { idx = (idx - 1 + slides.length) % slides.length; show(idx); });
setInterval(() => { idx = (idx + 1) % slides.length; show(idx); }, 6000);

// FAQ accordion
const accordions = document.querySelectorAll('.accordion-header');
accordions.forEach(btn => {
  btn.addEventListener('click', () => {
    const expanded = btn.getAttribute('aria-expanded') === 'true';
    btn.setAttribute('aria-expanded', String(!expanded));
    const panel = btn.nextElementSibling;
    if (!expanded){
      panel.style.maxHeight = panel.scrollHeight + 'px';
    } else {
      panel.style.maxHeight = 0;
    }
  });
});

// Footer year
const yearEl = document.getElementById('year');
if (yearEl) yearEl.textContent = new Date().getFullYear();

// Optional: enhance FormSubmit UX by preventing double submits
const form = document.querySelector('form[action^="https://formsubmit.co/"]');
if (form){
  form.addEventListener('submit', () => {
    const btn = form.querySelector('button[type="submit"]');
    if (btn){ btn.disabled = true; btn.textContent = 'Sending...'; }
  });
    }
